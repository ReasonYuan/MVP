//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/liaomin/Documents/workspace/Android/DocPlusLogic/src/com/fq/halcyon/uilogic/ChartModel.java
//
//  Created by liaomin on 15-5-4.
//

#line 1 "/Users/liaomin/Documents/workspace/Android/DocPlusLogic/src/com/fq/halcyon/uilogic/ChartModel.java"

#include "ChartModel.h"
#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "RecordExams.h"
#include "java/lang/Float.h"
#include "java/lang/Math.h"
#include "java/util/ArrayList.h"


#line 11
@implementation ComFqHalcyonUilogicChartModel


#line 71
- (id)initWithComFqHalcyonEntityRecordExams:(ComFqHalcyonEntityRecordExams *)exams {
  if (self = [super init]) {
    DISPLAY_PADDING_RATIO_ =
#line 20
    0.1f;
    scale__ =
#line 25
    1;
    yDisplayLabels_ = [IOSObjectArray arrayWithLength:
#line 30
    20 type:[IOSClass classWithClass:[NSString class]]];
    yStepHeight_ =
#line 35
    0;
    xStepWidth_ =
#line 40
    100;
    refType_ =
#line 52
    ComFqHalcyonUilogicChartModel_REF_TYPE_RANGE;
    lowestValue_ =
#line 57
    0;
    highestValue_ =
#line 62
    0;
    isDisplayInfoInited__ =
#line 69
    NO;
    
#line 72
    self->examData_ = exams;
  }
  return self;
}


#line 75
- (BOOL)isDisplayInfoInited {
  
#line 76
  return isDisplayInfoInited__;
}


#line 83
- (void)initDisplayInfoWithFloat:(float)screenHeight {
  
#line 84
  self->displayViewHeight_ = screenHeight * (1 - DISPLAY_PADDING_RATIO_ * 2);
  self->screenHeight_ = screenHeight;
  isDisplayInfoInited__ = YES;
  
#line 89
  for (int i = 0; i < [((JavaUtilArrayList *) nil_chk([((ComFqHalcyonEntityRecordExams *) nil_chk(examData_)) getEXamDates])) size]; i++) {
    if (i == 0) {
      lowestValue_ = [self toFloatWithNSString:[((ComFqHalcyonEntityRecordExams_ExamDate *) nil_chk([((JavaUtilArrayList *) nil_chk([examData_ getEXamDates])) getWithInt:i])) getValue]];
      highestValue_ = [self toFloatWithNSString:[((ComFqHalcyonEntityRecordExams_ExamDate *) nil_chk([((JavaUtilArrayList *) nil_chk([examData_ getEXamDates])) getWithInt:i])) getValue]];
    }
    else {
      
#line 94
      lowestValue_ = [JavaLangMath minWithFloat:lowestValue_ withFloat:[self toFloatWithNSString:[((ComFqHalcyonEntityRecordExams_ExamDate *) nil_chk([((JavaUtilArrayList *) nil_chk([examData_ getEXamDates])) getWithInt:i])) getValue]]];
      highestValue_ = [JavaLangMath maxWithFloat:highestValue_ withFloat:[self toFloatWithNSString:[((ComFqHalcyonEntityRecordExams_ExamDate *) nil_chk([((JavaUtilArrayList *) nil_chk([examData_ getEXamDates])) getWithInt:i])) getValue]]];
    }
  }
  
#line 99
  if ([((JavaUtilArrayList *) nil_chk([examData_ getEXamDates])) size] == 1 || lowestValue_ == highestValue_) {
    float nowValue = lowestValue_;
    lowestValue_ = nowValue * 0.8f;
    highestValue_ = nowValue * 1.2f;
  }
  float displayRange = highestValue_ - lowestValue_;
  
#line 106
  float yTotalHight = displayRange * ComFqHalcyonUilogicChartModel_TOTAL_DISPLAY_EXTENDS;
  
#line 108
  for (int i = 1; i <= (int) [((IOSObjectArray *) nil_chk(yDisplayLabels_)) count]; i++) {
    (void) IOSObjectArray_Set(yDisplayLabels_, i - 1, [NSString formatWithNSString:@"%.2f" withNSObjectArray:[IOSObjectArray arrayWithObjects:(id[]){ [JavaLangFloat valueOfWithFloat:yTotalHight * i / (int) [yDisplayLabels_ count] + (lowestValue_ - displayRange * (ComFqHalcyonUilogicChartModel_TOTAL_DISPLAY_EXTENDS - 1) / 2)] } count:1 type:[IOSClass classWithClass:[NSObject class]]]]);
  }
  
#line 112
  xPositions_ = [IOSFloatArray arrayWithLength:[((JavaUtilArrayList *) nil_chk([examData_ getEXamDates])) size]];
  for (int i = 0; i < (int) [xPositions_ count]; i++) {
    (*IOSFloatArray_GetRef(xPositions_, i)) = (i + 1) * xStepWidth_;
  }
  yStepHeight_ = displayViewHeight_ / (int) [yDisplayLabels_ count];
}


#line 119
- (float)toFloatWithNSString:(NSString *)str {
  
#line 120
  return [JavaLangFloat parseFloatWithNSString:str];
}


#line 128
- (float)getYByValueWithFloat:(float)value {
  
#line 129
  float displayRange = highestValue_ - lowestValue_;
  
#line 131
  float yTotalHight = displayRange * ComFqHalcyonUilogicChartModel_TOTAL_DISPLAY_EXTENDS;
  float vr = value - lowestValue_;
  return ((yTotalHight - displayRange) / 2 + vr) / yTotalHight * (yStepHeight_ * (int) [((IOSObjectArray *) nil_chk(yDisplayLabels_)) count]);
}


#line 140
- (float)getYStepHeight {
  
#line 141
  return yStepHeight_;
}


#line 148
- (float)getXStepWidth {
  
#line 149
  return xStepWidth_;
}


#line 156
- (int)getYCellsNum {
  
#line 157
  return (int) [((IOSObjectArray *) nil_chk(yDisplayLabels_)) count];
}


#line 164
- (float)getStartX {
  
#line 165
  return 60;
}


#line 172
- (float)getStartY {
  
#line 173
  return (screenHeight_ - displayViewHeight_) / 2;
}


#line 180
- (float)getChartMaxY {
  
#line 181
  return displayViewHeight_ * 1.1f;
}


#line 188
- (float)getChartWidth {
  
#line 189
  return xStepWidth_ * [((JavaUtilArrayList *) nil_chk([((ComFqHalcyonEntityRecordExams *) nil_chk(examData_)) getEXamDates])) size];
}


#line 197
- (NSString *)getYLabelWithInt:(int)stepIndex {
  
#line 198
  return IOSObjectArray_Get(nil_chk(yDisplayLabels_), stepIndex);
}


#line 205
- (JavaUtilArrayList *)getExamData {
  
#line 206
  return [((ComFqHalcyonEntityRecordExams *) nil_chk(examData_)) getEXamDates];
}

- (void)copyAllFieldsTo:(ComFqHalcyonUilogicChartModel *)other {
  [super copyAllFieldsTo:other];
  other->DISPLAY_PADDING_RATIO_ = DISPLAY_PADDING_RATIO_;
  other->displayViewHeight_ = displayViewHeight_;
  other->examData_ = examData_;
  other->highestValue_ = highestValue_;
  other->isDisplayInfoInited__ = isDisplayInfoInited__;
  other->lowestValue_ = lowestValue_;
  other->refType_ = refType_;
  other->scale__ = scale__;
  other->screenHeight_ = screenHeight_;
  other->xPositions_ = xPositions_;
  other->xStepWidth_ = xStepWidth_;
  other->yDisplayLabels_ = yDisplayLabels_;
  other->yStepHeight_ = yStepHeight_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "initWithComFqHalcyonEntityRecordExams:", "ChartModel", NULL, 0x1, NULL },
    { "isDisplayInfoInited", NULL, "Z", 0x1, NULL },
    { "initDisplayInfoWithFloat:", "initDisplayInfo", "V", 0x1, NULL },
    { "toFloatWithNSString:", "toFloat", "F", 0x2, NULL },
    { "getYByValueWithFloat:", "getYByValue", "F", 0x1, NULL },
    { "getYStepHeight", NULL, "F", 0x1, NULL },
    { "getXStepWidth", NULL, "F", 0x1, NULL },
    { "getYCellsNum", NULL, "I", 0x1, NULL },
    { "getStartX", NULL, "F", 0x1, NULL },
    { "getStartY", NULL, "F", 0x1, NULL },
    { "getChartMaxY", NULL, "F", 0x1, NULL },
    { "getChartWidth", NULL, "F", 0x1, NULL },
    { "getYLabelWithInt:", "getYLabel", "Ljava.lang.String;", 0x1, NULL },
    { "getExamData", NULL, "Ljava.util.ArrayList;", 0x1, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "TOTAL_DISPLAY_EXTENDS_", NULL, 0x1a, "F", NULL, .constantValue.asFloat = ComFqHalcyonUilogicChartModel_TOTAL_DISPLAY_EXTENDS },
    { "displayViewHeight_", NULL, 0x2, "F", NULL,  },
    { "screenHeight_", NULL, 0x2, "F", NULL,  },
    { "DISPLAY_PADDING_RATIO_", NULL, 0x12, "F", NULL,  },
    { "scale__", "scale", 0x2, "F", NULL,  },
    { "yDisplayLabels_", NULL, 0x2, "[Ljava.lang.String;", NULL,  },
    { "yStepHeight_", NULL, 0x2, "F", NULL,  },
    { "xStepWidth_", NULL, 0x12, "F", NULL,  },
    { "xPositions_", NULL, 0x2, "[F", NULL,  },
    { "examData_", NULL, 0x2, "Lcom.fq.halcyon.entity.RecordExams;", NULL,  },
    { "refType_", NULL, 0x2, "F", NULL,  },
    { "lowestValue_", NULL, 0x2, "F", NULL,  },
    { "highestValue_", NULL, 0x2, "F", NULL,  },
    { "REF_TYPE_RANGE_", NULL, 0x19, "I", NULL, .constantValue.asInt = ComFqHalcyonUilogicChartModel_REF_TYPE_RANGE },
    { "isDisplayInfoInited__", "isDisplayInfoInited", 0x2, "Z", NULL,  },
  };
  static J2ObjcClassInfo _ComFqHalcyonUilogicChartModel = { "ChartModel", "com.fq.halcyon.uilogic", NULL, 0x1, 14, methods, 15, fields, 0, NULL};
  return &_ComFqHalcyonUilogicChartModel;
}

@end
